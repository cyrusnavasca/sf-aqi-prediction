import pandas as pd
import os
from datetime import datetime, timezone
from pathlib import Path
from typing import Optional
from zenml import step
import logging
from dotenv import load_dotenv
from src.data_ingestion import IngestLiveData

# Load .env file
load_dotenv()

@step 
def ingest_data() -> pd.DataFrame:
    try:
        return IngestLiveData().get_data()
    except Exception as e:
        logging.exception(f"Failed to ingest data: {e}", exc_info=True)
        raise